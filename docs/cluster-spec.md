---
title: Cluster Specs
order: 20
---

A *cluster spec* describes how to build and deploy a Taskcluster release.

A cluster spec is represented either as a directory containing several `.yml` files, or as a JSON object.
The contents are the same, but the `.yml` format is intended to be human-editable.

# build.yml

The `build.yml` file (or, in a JSON blob, the `build` property) contains a property `repositories` listing the repositories from which the cluster is to be built.

Each element in this array has:

* `name` -- the short name (for services, without a `taskcluster-` prefix; for libraries, the name used with `yarn add`)
* `kind` -- the kind of repository, in other words how it should be built
* `source` -- the source for the repository, in `gitRepo#ref` format
* `exactSource` -- (generated by build process) similar to `source`, but with a commit sha1 as the reference
* `docs` -- information about docs and metadata for this repository; either `false` (not documented), `'generated'` (generated by the build process), or an object (to generate the docs automatically).

The docs property, if an object, has properties:

* `tier` -- the documentation tier for this repository
* `menuIndex` -- (optional) the sorting order for this item in the docs index

The following kinds are defined:

## `service`

For `kind='service'`, there is an additional `service` property with:

* `buildType` -- the type of service build (see below)
* `dockerImage` -- (generated by build process) the docker image containing this service

For `buildType == "heroku-buildpack"`, there are additional properties `stack` (the Heroku stack on which the image is based) and `buildpack` (the URL of the buildpack repository).

The tools and docs sites are special-cased with `buildType == "tools-ui"` `buildType == "docs"`, which has the additional property `node` giving the node version.

## `other`

This kind represents repositories that are not built into services or other ouptuts, but may contribute other metadata such as documentation.

# deploy.yml

The `deploy.yml` file (or, in a JSON blob, the `deploy` property) contains a JSON-e expression which will evaluate to object with properties:

* `resources` -- an array of objects describing Kubernetes resources to create; each should have at least `name`, `kind`, and `apiVersion`.

The deploy process will perform the JSON-e rendering, then write each resource out for consumption by kubectl.

# ingress.yml

The `ingress.yml` file (or ina JSON blob, the `ingress` property) contains a JSON-e expression that must evaluate to a valid Kubernetes
[ingress](https://kubernetes.io/docs/concepts/services-networking/ingress/) resource.

The deploy process will perform the JSON-e rendering, then write the ingress resource out for consumption by kubectl.
